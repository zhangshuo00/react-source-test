{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\nimport ReactCurrentBatchConfig from './ReactCurrentBatchConfig';\nimport { warnOnSubscriptionInsideStartTransition } from 'shared/ReactFeatureFlags';\nexport function startTransition(scope) {\n  const prevTransition = ReactCurrentBatchConfig.transition;\n  ReactCurrentBatchConfig.transition = 1;\n\n  try {\n    scope();\n  } finally {\n    ReactCurrentBatchConfig.transition = prevTransition;\n\n    if (__DEV__) {\n      if (prevTransition !== 1 && warnOnSubscriptionInsideStartTransition && ReactCurrentBatchConfig._updatedFibers) {\n        const updatedFibersCount = ReactCurrentBatchConfig._updatedFibers.size;\n\n        if (updatedFibersCount > 10) {\n          console.warn('Detected a large number of updates inside startTransition. ' + 'If this is due to a subscription please re-write it to use React provided hooks. ' + 'Otherwise concurrent mode guarantees are off the table.');\n        }\n\n        ReactCurrentBatchConfig._updatedFibers.clear();\n      }\n    }\n  }\n}","map":{"version":3,"sources":["/Users/zhangshuo/git/my-app/src/react/packages/react/src/ReactStartTransition.js"],"names":["ReactCurrentBatchConfig","warnOnSubscriptionInsideStartTransition","startTransition","scope","prevTransition","transition","__DEV__","_updatedFibers","updatedFibersCount","size","console","warn","clear"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,uBAAP,MAAoC,2BAApC;AACA,SAAQC,uCAAR,QAAsD,0BAAtD;AAEA,OAAO,SAASC,eAAT,CAAyBC,KAAzB,EAA4C;AACjD,QAAMC,cAAc,GAAGJ,uBAAuB,CAACK,UAA/C;AACAL,EAAAA,uBAAuB,CAACK,UAAxB,GAAqC,CAArC;;AACA,MAAI;AACFF,IAAAA,KAAK;AACN,GAFD,SAEU;AACRH,IAAAA,uBAAuB,CAACK,UAAxB,GAAqCD,cAArC;;AACA,QAAIE,OAAJ,EAAa;AACX,UACEF,cAAc,KAAK,CAAnB,IACAH,uCADA,IAEAD,uBAAuB,CAACO,cAH1B,EAIE;AACA,cAAMC,kBAAkB,GAAGR,uBAAuB,CAACO,cAAxB,CAAuCE,IAAlE;;AACA,YAAID,kBAAkB,GAAG,EAAzB,EAA6B;AAC3BE,UAAAA,OAAO,CAACC,IAAR,CACE,gEACE,mFADF,GAEE,yDAHJ;AAKD;;AACDX,QAAAA,uBAAuB,CAACO,cAAxB,CAAuCK,KAAvC;AACD;AACF;AACF;AACF","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport ReactCurrentBatchConfig from './ReactCurrentBatchConfig';\nimport {warnOnSubscriptionInsideStartTransition} from 'shared/ReactFeatureFlags';\n\nexport function startTransition(scope: () => void) {\n  const prevTransition = ReactCurrentBatchConfig.transition;\n  ReactCurrentBatchConfig.transition = 1;\n  try {\n    scope();\n  } finally {\n    ReactCurrentBatchConfig.transition = prevTransition;\n    if (__DEV__) {\n      if (\n        prevTransition !== 1 &&\n        warnOnSubscriptionInsideStartTransition &&\n        ReactCurrentBatchConfig._updatedFibers\n      ) {\n        const updatedFibersCount = ReactCurrentBatchConfig._updatedFibers.size;\n        if (updatedFibersCount > 10) {\n          console.warn(\n            'Detected a large number of updates inside startTransition. ' +\n              'If this is due to a subscription please re-write it to use React provided hooks. ' +\n              'Otherwise concurrent mode guarantees are off the table.',\n          );\n        }\n        ReactCurrentBatchConfig._updatedFibers.clear();\n      }\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}