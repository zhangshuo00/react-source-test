{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport { warnsIfNotActing } from './ReactFiberHostConfig';\nconst {\n  ReactCurrentActQueue\n} = ReactSharedInternals;\nexport function isLegacyActEnvironment(fiber) {\n  if (__DEV__) {\n    // Legacy mode. We preserve the behavior of React 17's act. It assumes an\n    // act environment whenever `jest` is defined, but you can still turn off\n    // spurious warnings by setting IS_REACT_ACT_ENVIRONMENT explicitly\n    // to false.\n    const isReactActEnvironmentGlobal = // $FlowExpectedError – Flow doesn't know about IS_REACT_ACT_ENVIRONMENT global\n    typeof IS_REACT_ACT_ENVIRONMENT !== 'undefined' ? IS_REACT_ACT_ENVIRONMENT : undefined; // $FlowExpectedError - Flow doesn't know about jest\n\n    const jestIsDefined = typeof jest !== 'undefined';\n    return warnsIfNotActing && jestIsDefined && isReactActEnvironmentGlobal !== false;\n  }\n\n  return false;\n}\nexport function isConcurrentActEnvironment() {\n  if (__DEV__) {\n    const isReactActEnvironmentGlobal = // $FlowExpectedError – Flow doesn't know about IS_REACT_ACT_ENVIRONMENT global\n    typeof IS_REACT_ACT_ENVIRONMENT !== 'undefined' ? IS_REACT_ACT_ENVIRONMENT : undefined;\n\n    if (!isReactActEnvironmentGlobal && ReactCurrentActQueue.current !== null) {\n      // TODO: Include link to relevant documentation page.\n      console.error('The current testing environment is not configured to support ' + 'act(...)');\n    }\n\n    return isReactActEnvironmentGlobal;\n  }\n\n  return false;\n}","map":{"version":3,"sources":["/Users/zhangshuo/git/react-source-test/src/react/packages/react-reconciler/src/ReactFiberAct.new.js"],"names":["ReactSharedInternals","warnsIfNotActing","ReactCurrentActQueue","isLegacyActEnvironment","fiber","__DEV__","isReactActEnvironmentGlobal","IS_REACT_ACT_ENVIRONMENT","undefined","jestIsDefined","jest","isConcurrentActEnvironment","current","console","error"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA,OAAOA,oBAAP,MAAiC,6BAAjC;AAEA,SAAQC,gBAAR,QAA+B,wBAA/B;AAEA,MAAM;AAACC,EAAAA;AAAD,IAAyBF,oBAA/B;AAEA,OAAO,SAASG,sBAAT,CAAgCC,KAAhC,EAA8C;AACnD,MAAIC,OAAJ,EAAa;AACX;AACA;AACA;AACA;AAEA,UAAMC,2BAA2B,GAC/B;AACA,WAAOC,wBAAP,KAAoC,WAApC,GACIA,wBADJ,GAEIC,SAJN,CANW,CAYX;;AACA,UAAMC,aAAa,GAAG,OAAOC,IAAP,KAAgB,WAAtC;AACA,WACET,gBAAgB,IAAIQ,aAApB,IAAqCH,2BAA2B,KAAK,KADvE;AAGD;;AACD,SAAO,KAAP;AACD;AAED,OAAO,SAASK,0BAAT,GAAsC;AAC3C,MAAIN,OAAJ,EAAa;AACX,UAAMC,2BAA2B,GAC/B;AACA,WAAOC,wBAAP,KAAoC,WAApC,GACIA,wBADJ,GAEIC,SAJN;;AAMA,QAAI,CAACF,2BAAD,IAAgCJ,oBAAoB,CAACU,OAArB,KAAiC,IAArE,EAA2E;AACzE;AACAC,MAAAA,OAAO,CAACC,KAAR,CACE,kEACE,UAFJ;AAID;;AACD,WAAOR,2BAAP;AACD;;AACD,SAAO,KAAP;AACD","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Fiber} from './ReactFiber.new';\n\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\n\nimport {warnsIfNotActing} from './ReactFiberHostConfig';\n\nconst {ReactCurrentActQueue} = ReactSharedInternals;\n\nexport function isLegacyActEnvironment(fiber: Fiber) {\n  if (__DEV__) {\n    // Legacy mode. We preserve the behavior of React 17's act. It assumes an\n    // act environment whenever `jest` is defined, but you can still turn off\n    // spurious warnings by setting IS_REACT_ACT_ENVIRONMENT explicitly\n    // to false.\n\n    const isReactActEnvironmentGlobal =\n      // $FlowExpectedError – Flow doesn't know about IS_REACT_ACT_ENVIRONMENT global\n      typeof IS_REACT_ACT_ENVIRONMENT !== 'undefined'\n        ? IS_REACT_ACT_ENVIRONMENT\n        : undefined;\n\n    // $FlowExpectedError - Flow doesn't know about jest\n    const jestIsDefined = typeof jest !== 'undefined';\n    return (\n      warnsIfNotActing && jestIsDefined && isReactActEnvironmentGlobal !== false\n    );\n  }\n  return false;\n}\n\nexport function isConcurrentActEnvironment() {\n  if (__DEV__) {\n    const isReactActEnvironmentGlobal =\n      // $FlowExpectedError – Flow doesn't know about IS_REACT_ACT_ENVIRONMENT global\n      typeof IS_REACT_ACT_ENVIRONMENT !== 'undefined'\n        ? IS_REACT_ACT_ENVIRONMENT\n        : undefined;\n\n    if (!isReactActEnvironmentGlobal && ReactCurrentActQueue.current !== null) {\n      // TODO: Include link to relevant documentation page.\n      console.error(\n        'The current testing environment is not configured to support ' +\n          'act(...)',\n      );\n    }\n    return isReactActEnvironmentGlobal;\n  }\n  return false;\n}\n"]},"metadata":{},"sourceType":"module"}